{"cells":[{"cell_type":"markdown","source":["# IMPORTING LIBRARIES"],"metadata":{"id":"Tf9I2hFlI6RF"}},{"cell_type":"code","source":["import pandas as pd\n","import numpy as np\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import accuracy_score\n","from sklearn.metrics import classification_report\n","import re\n","import string"],"metadata":{"id":"OgAT9QW-JBJj","executionInfo":{"status":"ok","timestamp":1721464508920,"user_tz":-480,"elapsed":1668,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":1,"outputs":[]},{"cell_type":"markdown","source":["# IMPORTING DATASETS"],"metadata":{"id":"iWzM-D1FJCPb"}},{"cell_type":"code","source":["df_fake = pd.read_csv(\"/content/Fake.csv\")\n","df_true = pd.read_csv(\"/content/True.csv\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":217},"id":"Mz4q3Mw2JHaJ","executionInfo":{"status":"error","timestamp":1721464510111,"user_tz":-480,"elapsed":27,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"a829b3ad-2ac8-44b0-a7d0-b4dc83d552ad"},"execution_count":2,"outputs":[{"output_type":"error","ename":"ParserError","evalue":"Error tokenizing data. C error: EOF inside string starting at row 404","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mParserError\u001b[0m                               Traceback (most recent call last)","\u001b[0;32m<ipython-input-2-1830dfe0a668>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdf_fake\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_csv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/content/Fake.csv\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mdf_true\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_csv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/content/True.csv\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36mread_csv\u001b[0;34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)\u001b[0m\n\u001b[1;32m    910\u001b[0m     \u001b[0mkwds\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mupdate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkwds_defaults\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    911\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 912\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0m_read\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilepath_or_buffer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    913\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    914\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36m_read\u001b[0;34m(filepath_or_buffer, kwds)\u001b[0m\n\u001b[1;32m    581\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    582\u001b[0m     \u001b[0;32mwith\u001b[0m \u001b[0mparser\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 583\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mparser\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnrows\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    584\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    585\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self, nrows)\u001b[0m\n\u001b[1;32m   1702\u001b[0m                     \u001b[0mcolumns\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1703\u001b[0m                     \u001b[0mcol_dict\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1704\u001b[0;31m                 \u001b[0;34m)\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_engine\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m  \u001b[0;31m# type: ignore[attr-defined]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1705\u001b[0m                     \u001b[0mnrows\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1706\u001b[0m                 )\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/c_parser_wrapper.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self, nrows)\u001b[0m\n\u001b[1;32m    232\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    233\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlow_memory\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 234\u001b[0;31m                 \u001b[0mchunks\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_reader\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_low_memory\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnrows\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    235\u001b[0m                 \u001b[0;31m# destructive to chunks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    236\u001b[0m                 \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_concatenate_chunks\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mchunks\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/parsers.pyx\u001b[0m in \u001b[0;36mpandas._libs.parsers.TextReader.read_low_memory\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/parsers.pyx\u001b[0m in \u001b[0;36mpandas._libs.parsers.TextReader._read_rows\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/parsers.pyx\u001b[0m in \u001b[0;36mpandas._libs.parsers.TextReader._tokenize_rows\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/parsers.pyx\u001b[0m in \u001b[0;36mpandas._libs.parsers.TextReader._check_tokenize_status\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/parsers.pyx\u001b[0m in \u001b[0;36mpandas._libs.parsers.raise_parser_error\u001b[0;34m()\u001b[0m\n","\u001b[0;31mParserError\u001b[0m: Error tokenizing data. C error: EOF inside string starting at row 404"]}]},{"cell_type":"code","source":["df_fake.head()"],"metadata":{"id":"5gOdZdnHJPt_","executionInfo":{"status":"aborted","timestamp":1721464510111,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_true.head(5)"],"metadata":{"id":"aqnjFTtgJQVe","executionInfo":{"status":"aborted","timestamp":1721464510112,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["*Inserting a column \"class\" as target feature*"],"metadata":{"id":"4ymngwnJJV82"}},{"cell_type":"code","source":["df_fake[\"class\"] = 0\n","df_true[\"class\"] = 1"],"metadata":{"id":"Wrdaepy3JcGT","executionInfo":{"status":"aborted","timestamp":1721464510112,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_fake.shape, df_true.shape"],"metadata":{"id":"fS1Q8gjWJeOC","executionInfo":{"status":"aborted","timestamp":1721464510112,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Removing last 10 rows for manual testing\n","df_fake_manual_testing = df_fake.tail(10)\n","for i in range(23480,23470,-1):\n","    df_fake.drop([i], axis = 0, inplace = True)\n","\n","\n","df_true_manual_testing = df_true.tail(10)\n","for i in range(21416,21406,-1):\n","    df_true.drop([i], axis = 0, inplace = True)"],"metadata":{"id":"VBxhHEdoJhuj","executionInfo":{"status":"aborted","timestamp":1721464510112,"user_tz":-480,"elapsed":21,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_fake.shape, df_true.shape"],"metadata":{"id":"ruSoi3SsJieT","executionInfo":{"status":"aborted","timestamp":1721464510113,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_fake_manual_testing[\"class\"] = 0\n","df_true_manual_testing[\"class\"] = 1"],"metadata":{"id":"S3bXQbkhJkbZ","executionInfo":{"status":"aborted","timestamp":1721464510113,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_fake_manual_testing.head(10)"],"metadata":{"id":"T4OdiZggJoKr","executionInfo":{"status":"aborted","timestamp":1721464510113,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_true_manual_testing.head(10)"],"metadata":{"id":"qz2tfGPFJq3v","executionInfo":{"status":"aborted","timestamp":1721464510114,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_manual_testing = pd.concat([df_fake_manual_testing,df_true_manual_testing], axis = 0)\n","df_manual_testing.to_csv(\"manual_testing.csv\")"],"metadata":{"id":"6LCDn2KzJt03","executionInfo":{"status":"aborted","timestamp":1721464510114,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# MERGING TRUE AND FAKE DATAFRAMES"],"metadata":{"id":"qDFWGKpmJukU"}},{"cell_type":"code","source":["df_merge = pd.concat([df_fake, df_true], axis =0 )\n","df_merge.head(10)"],"metadata":{"id":"4OqhZPIPJ4L5","executionInfo":{"status":"aborted","timestamp":1721464510114,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_merge.columns"],"metadata":{"id":"_POwdDwbJ9OU","executionInfo":{"status":"aborted","timestamp":1721464510115,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# REMOVING COLUMNS WHICH ARE NOT REQUIRED"],"metadata":{"id":"2LyK8-G2J_O_"}},{"cell_type":"code","source":["df = df_merge.drop([\"title\", \"subject\",\"date\"], axis = 1)"],"metadata":{"id":"GJDe63aNKHe0","executionInfo":{"status":"aborted","timestamp":1721464510115,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.isnull().sum()"],"metadata":{"id":"pgqXbFFTKJas","executionInfo":{"status":"aborted","timestamp":1721464510116,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# RANDOM SHUFFLING THE DATAFRAME"],"metadata":{"id":"Ya-4-MNIKNQd"}},{"cell_type":"code","source":["df = df.sample(frac = 1)"],"metadata":{"id":"yAnB-9JoKR3T","executionInfo":{"status":"aborted","timestamp":1721464510116,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.head()"],"metadata":{"id":"zURJSScFKShi","executionInfo":{"status":"aborted","timestamp":1721464510116,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.reset_index(inplace = True)\n","df.drop([\"index\"], axis = 1, inplace = True)"],"metadata":{"id":"ebb0dWDSKUw8","executionInfo":{"status":"aborted","timestamp":1721464510116,"user_tz":-480,"elapsed":21,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.columns"],"metadata":{"id":"WmVgCOdDKW4N","executionInfo":{"status":"aborted","timestamp":1721464510117,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.head()"],"metadata":{"id":"jf_KXad6KY7q","executionInfo":{"status":"aborted","timestamp":1721464510117,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["*Creating a function to process the texts*"],"metadata":{"id":"EAA0Fr0sKeEs"}},{"cell_type":"code","source":["def wordopt(text):\n","    text = text.lower()\n","    text = re.sub('\\[.*?\\]', '', text)\n","    text = re.sub(\"\\\\W\",\" \",text)\n","    text = re.sub('https?://\\S+|www\\.\\S+', '', text)\n","    text = re.sub('<.*?>+', '', text)\n","    text = re.sub('[%s]' % re.escape(string.punctuation), '', text)\n","    text = re.sub('\\n', '', text)\n","    text = re.sub('\\w*\\d\\w*', '', text)\n","    return text"],"metadata":{"id":"35OzpWZjKgrn","executionInfo":{"status":"aborted","timestamp":1721464510117,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df[\"text\"] = df[\"text\"].apply(wordopt)"],"metadata":{"id":"Ai5CCV_JKjxz","executionInfo":{"status":"aborted","timestamp":1721464510117,"user_tz":-480,"elapsed":21,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["*Defining dependent and independent variables*"],"metadata":{"id":"ZIOP5ATtKkab"}},{"cell_type":"code","source":["x = df[\"text\"]\n","y = df[\"class\"]"],"metadata":{"id":"vEiso7J7KnSr","executionInfo":{"status":"aborted","timestamp":1721464510117,"user_tz":-480,"elapsed":21,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["*Splitting Training and Testing*"],"metadata":{"id":"AmYH4FATKpaN"}},{"cell_type":"code","source":["x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25)"],"metadata":{"id":"ZAVLrRvSKtKK","executionInfo":{"status":"aborted","timestamp":1721464510118,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Convert text to vectors"],"metadata":{"id":"36huQHeNKvfG"}},{"cell_type":"code","source":["from sklearn.feature_extraction.text import TfidfVectorizer\n","\n","vectorization = TfidfVectorizer()\n","xv_train = vectorization.fit_transform(x_train)\n","xv_test = vectorization.transform(x_test)"],"metadata":{"id":"_Hjky0nVKzK5","executionInfo":{"status":"aborted","timestamp":1721464510118,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Logistic Regression"],"metadata":{"id":"PMQxuPkhK1G_"}},{"cell_type":"code","source":["from sklearn.linear_model import LogisticRegression\n","\n","LR = LogisticRegression()\n","LR.fit(xv_train,y_train)"],"metadata":{"id":"3fc2jsVPK43p","executionInfo":{"status":"aborted","timestamp":1721464510118,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pred_lr=LR.predict(xv_test)"],"metadata":{"id":"5wK43QFMK8-l","executionInfo":{"status":"aborted","timestamp":1721464510118,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["LR.score(xv_test, y_test)"],"metadata":{"id":"1TEM5a3IK-7j","executionInfo":{"status":"aborted","timestamp":1721464510119,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(classification_report(y_test, pred_lr))"],"metadata":{"id":"Z0dm7g2BLA6L","executionInfo":{"status":"aborted","timestamp":1721464510119,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Decision Tree Classification"],"metadata":{"id":"7px8asA1K7JH"}},{"cell_type":"code","source":["from sklearn.tree import DecisionTreeClassifier\n","\n","DT = DecisionTreeClassifier()\n","DT.fit(xv_train, y_train)"],"metadata":{"id":"vbazsFJ-LFGX","executionInfo":{"status":"aborted","timestamp":1721464510119,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pred_dt = DT.predict(xv_test)"],"metadata":{"id":"Qjhx20ZqLHSW","executionInfo":{"status":"aborted","timestamp":1721464510119,"user_tz":-480,"elapsed":22,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["DT.score(xv_test, y_test)"],"metadata":{"id":"YKVomfbfLJQg","executionInfo":{"status":"aborted","timestamp":1721464510120,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(classification_report(y_test, pred_dt))"],"metadata":{"id":"r244AzH5LLTE","executionInfo":{"status":"aborted","timestamp":1721464510120,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Gradient Boosting Classifier"],"metadata":{"id":"VyB1XCcFLN95"}},{"cell_type":"code","source":["from sklearn.ensemble import GradientBoostingClassifier\n","\n","GBC = GradientBoostingClassifier(random_state=0)\n","GBC.fit(xv_train, y_train)"],"metadata":{"id":"zkqcMH6WLRlk","executionInfo":{"status":"aborted","timestamp":1721464510120,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pred_gbc = GBC.predict(xv_test)"],"metadata":{"id":"oml3t3GtLTmC","executionInfo":{"status":"aborted","timestamp":1721464510120,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["GBC.score(xv_test, y_test)"],"metadata":{"id":"pJn9gBN-LVkk","executionInfo":{"status":"aborted","timestamp":1721464510121,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(classification_report(y_test, pred_gbc))"],"metadata":{"id":"zsCqLmiPLXaS","executionInfo":{"status":"aborted","timestamp":1721464510121,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Random Forest Classifier"],"metadata":{"id":"XMqChJ6aLZ2w"}},{"cell_type":"code","source":["from sklearn.ensemble import RandomForestClassifier\n","\n","RFC = RandomForestClassifier(random_state=0)\n","RFC.fit(xv_train, y_train)"],"metadata":{"id":"vESMkI0rLeX4","executionInfo":{"status":"aborted","timestamp":1721464510121,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pred_rfc = RFC.predict(xv_test)"],"metadata":{"id":"gH0FvZD2LgKI","executionInfo":{"status":"aborted","timestamp":1721464510121,"user_tz":-480,"elapsed":23,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["RFC.score(xv_test, y_test)"],"metadata":{"id":"S0Kgm_s0Lhyy","executionInfo":{"status":"aborted","timestamp":1721464510122,"user_tz":-480,"elapsed":24,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(classification_report(y_test, pred_rfc))"],"metadata":{"id":"ZZxLkQXPLk_2","executionInfo":{"status":"aborted","timestamp":1721464510122,"user_tz":-480,"elapsed":24,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Model Testing"],"metadata":{"id":"qDQIK6o9LmKq"}},{"cell_type":"code","source":["def output_lable(n):\n","    if n == 0:\n","        return \"Fake News\"\n","    elif n == 1:\n","        return \"Not A Fake News\"\n","\n","def manual_testing(news):\n","    testing_news = {\"text\":[news]}\n","    new_def_test = pd.DataFrame(testing_news)\n","    new_def_test[\"text\"] = new_def_test[\"text\"].apply(wordopt)\n","    new_x_test = new_def_test[\"text\"]\n","    new_xv_test = vectorization.transform(new_x_test)\n","    pred_LR = LR.predict(new_xv_test)\n","    pred_DT = DT.predict(new_xv_test)\n","    pred_GBC = GBC.predict(new_xv_test)\n","    pred_RFC = RFC.predict(new_xv_test)\n","\n","    return print(\"\\n\\nLR Prediction: {} \\nDT Prediction: {} \\nGBC Prediction: {} \\nRFC Prediction: {}\".format(output_lable(pred_LR[0]),                                                                                                       output_lable(pred_DT[0]),\n","                                                                                                              output_lable(pred_GBC[0]),\n","                                                                                                              output_lable(pred_RFC[0])))"],"metadata":{"id":"ktMckSbLLo47","executionInfo":{"status":"aborted","timestamp":1721464510122,"user_tz":-480,"elapsed":24,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["news = str(input())\n","manual_testing(news)"],"metadata":{"id":"q0qOJn-LLypt","executionInfo":{"status":"aborted","timestamp":1721464510122,"user_tz":-480,"elapsed":24,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["news = str(input())\n","manual_testing(news)"],"metadata":{"id":"w3efy4fHL0dM","executionInfo":{"status":"aborted","timestamp":1721464510123,"user_tz":-480,"elapsed":25,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["news = str(input())\n","manual_testing(news)"],"metadata":{"id":"kLt0SDwjL2hJ","executionInfo":{"status":"aborted","timestamp":1721464510123,"user_tz":-480,"elapsed":25,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","provenance":[{"file_id":"1TDYYM_Ztxj3dsS2HTYeFXwgexeKAmzgQ","timestamp":1721464395631}],"authorship_tag":"ABX9TyOSyp4j98WkPfvRWxph7VMx"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}