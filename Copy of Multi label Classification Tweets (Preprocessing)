{"cells":[{"source":["\n","# IMPORTANT: RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES\n","# TO THE CORRECT LOCATION (/kaggle/input) IN YOUR NOTEBOOK,\n","# THEN FEEL FREE TO DELETE THIS CELL.\n","# NOTE: THIS NOTEBOOK ENVIRONMENT DIFFERS FROM KAGGLE'S PYTHON\n","# ENVIRONMENT SO THERE MAY BE MISSING LIBRARIES USED BY YOUR\n","# NOTEBOOK.\n","\n","import os\n","import sys\n","from tempfile import NamedTemporaryFile\n","from urllib.request import urlopen\n","from urllib.parse import unquote, urlparse\n","from urllib.error import HTTPError\n","from zipfile import ZipFile\n","import tarfile\n","import shutil\n","\n","CHUNK_SIZE = 40960\n","DATA_SOURCE_MAPPING = 'semeval-2018-task-ec:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F799496%2F1371314%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240611%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240611T034129Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3Dac59641385233dfc493a8eb65ffa44e7063a58dc822c4d9fe7eafcbe255f50a3a14dda8a190c41b1d4f1affec8c38259256a26c62f210bc357da04bd6624f85f2d5ea4814a73f412538e5fbb994fdec72d49b2fb26044eaee81efe16db5a636cc130e688a81906b5e6fb3e45ff876de7f8c5e1b95a6f78d16677f08ff90a1dd1cbcd632506dc4996b64cf23d5c7cb30768a0afe89cacb6d1a1eff991bbbc420a64cb65c5504bf17ab23a2ceaf8d6d897e2b64170c8fb0fe2f08945dabca7316aff6f8e13ae60484438cd2add1e66d4fdd6362a1214350cb8a650d89a79aa1098a77b9c5ec4253b432851891f4f96e03fe39f85e9891bbf8e7f20a8d1e94eb6bc'\n","\n","KAGGLE_INPUT_PATH='/kaggle/input'\n","KAGGLE_WORKING_PATH='/kaggle/working'\n","KAGGLE_SYMLINK='kaggle'\n","\n","!umount /kaggle/input/ 2> /dev/null\n","shutil.rmtree('/kaggle/input', ignore_errors=True)\n","os.makedirs(KAGGLE_INPUT_PATH, 0o777, exist_ok=True)\n","os.makedirs(KAGGLE_WORKING_PATH, 0o777, exist_ok=True)\n","\n","try:\n","  os.symlink(KAGGLE_INPUT_PATH, os.path.join(\"..\", 'input'), target_is_directory=True)\n","except FileExistsError:\n","  pass\n","try:\n","  os.symlink(KAGGLE_WORKING_PATH, os.path.join(\"..\", 'working'), target_is_directory=True)\n","except FileExistsError:\n","  pass\n","\n","for data_source_mapping in DATA_SOURCE_MAPPING.split(','):\n","    directory, download_url_encoded = data_source_mapping.split(':')\n","    download_url = unquote(download_url_encoded)\n","    filename = urlparse(download_url).path\n","    destination_path = os.path.join(KAGGLE_INPUT_PATH, directory)\n","    try:\n","        with urlopen(download_url) as fileres, NamedTemporaryFile() as tfile:\n","            total_length = fileres.headers['content-length']\n","            print(f'Downloading {directory}, {total_length} bytes compressed')\n","            dl = 0\n","            data = fileres.read(CHUNK_SIZE)\n","            while len(data) > 0:\n","                dl += len(data)\n","                tfile.write(data)\n","                done = int(50 * dl / int(total_length))\n","                sys.stdout.write(f\"\\r[{'=' * done}{' ' * (50-done)}] {dl} bytes downloaded\")\n","                sys.stdout.flush()\n","                data = fileres.read(CHUNK_SIZE)\n","            if filename.endswith('.zip'):\n","              with ZipFile(tfile) as zfile:\n","                zfile.extractall(destination_path)\n","            else:\n","              with tarfile.open(tfile.name) as tarfile:\n","                tarfile.extractall(destination_path)\n","            print(f'\\nDownloaded and uncompressed: {directory}')\n","    except HTTPError as e:\n","        print(f'Failed to load (likely expired) {download_url} to path {destination_path}')\n","        continue\n","    except OSError as e:\n","        print(f'Failed to load {download_url} to path {destination_path}')\n","        continue\n","\n","print('Data source import complete.')\n"],"metadata":{"id":"x5PUK_ndY7mr","executionInfo":{"status":"ok","timestamp":1718099155440,"user_tz":-480,"elapsed":1920,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"c5260369-5e70-4da7-c9e0-328c9d0a89c6","colab":{"base_uri":"https://localhost:8080/"}},"cell_type":"code","outputs":[{"output_type":"stream","name":"stdout","text":["Downloading semeval-2018-task-ec, 616176 bytes compressed\n","[==================================================] 616176 bytes downloaded\n","Downloaded and uncompressed: semeval-2018-task-ec\n","Data source import complete.\n"]}],"execution_count":1},{"metadata":{"id":"3zb5sjU1Y7mt"},"cell_type":"markdown","source":["# SemEval 2018 task E-c Tweets multi label classification"]},{"metadata":{"id":"z8t6m_5jY7mu"},"cell_type":"markdown","source":["Tweets are multi label classified into eleven emotions:\n","(anger, anticipation, disgust, fear, joy, love, optimism, pessimism, sadness, surprise, trust)"]},{"metadata":{"id":"1ttRBdWLY7mu"},"cell_type":"markdown","source":["This notebook outlines the preprocessing Phase:\n","* split hashtags\n","* translate emojis\n","* remove urls\n","* tokenize tweets\n","* remove stopwords & punctuations\n","* remove unneeded spaces"]},{"metadata":{"_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","trusted":true,"id":"ZzarWLoVY7mu","executionInfo":{"status":"ok","timestamp":1718099155441,"user_tz":-480,"elapsed":9,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"83a39be6-637d-4427-8652-54c5c44f0dc7","colab":{"base_uri":"https://localhost:8080/"}},"cell_type":"code","source":["import numpy as np # linear algebra\n","#import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","import os\n","\n","# List all files in the content directory\n","for dirname, _, filenames in os.walk('/content'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))"],"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/TEC.csv\n","/content/semeval2018-task1-emoc.txt\n","/content/goemotions_full.csv\n","/content/semeval2018-task1-emoc.csv\n","/content/goemotions_full.txt\n","/content/TEC.txt\n","/content/.config/.last_opt_in_prompt.yaml\n","/content/.config/.last_update_check.json\n","/content/.config/.last_survey_prompt.yaml\n","/content/.config/default_configs.db\n","/content/.config/active_config\n","/content/.config/gce\n","/content/.config/config_sentinel\n","/content/.config/logs/2024.06.07/13.33.04.641473.log\n","/content/.config/logs/2024.06.07/13.26.12.914332.log\n","/content/.config/logs/2024.06.07/13.38.43.068372.log\n","/content/.config/logs/2024.06.07/13.33.15.096641.log\n","/content/.config/logs/2024.06.07/13.38.54.113928.log\n","/content/.config/logs/2024.06.07/13.38.53.514069.log\n","/content/.config/configurations/config_default\n","/content/sample_data/anscombe.json\n","/content/sample_data/README.md\n","/content/sample_data/mnist_train_small.csv\n","/content/sample_data/mnist_test.csv\n","/content/sample_data/california_housing_train.csv\n","/content/sample_data/california_housing_test.csv\n"]}]},{"metadata":{"_uuid":"d629ff2d2480ee46fbb7e2d37f6b5fab8052498a","_cell_guid":"79c7e3d0-c299-4dcb-8224-4455121ee9b0","trusted":true,"id":"fiDdZ-umY7mv","executionInfo":{"status":"ok","timestamp":1718099159479,"user_tz":-480,"elapsed":4043,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["import pandas as pd\n","\n","# Load the training data\n","traindf = pd.read_csv('/content/semeval2018-task1-emoc.txt', encoding='utf-8', sep=\"\\t\")\n","\n","# Load the development data\n","devdf = pd.read_csv('/content/goemotions_full.txt', encoding='utf-8', sep=\"\\t\")\n","\n","# Load the test data\n","testdf = pd.read_csv('/content/TEC.txt', encoding='utf-8', sep=\"\\t\")\n","\n","# Load additional datasets\n","goemotions_full = pd.read_csv('/content/goemotions_full.csv', encoding='utf-8')\n","semeval2018_task1_emoc = pd.read_csv('/content/semeval2018-task1-emoc.csv', encoding='utf-8')\n","tec = pd.read_csv('/content/TEC.csv', encoding='utf-8')"],"execution_count":3,"outputs":[]},{"metadata":{"trusted":true,"id":"1MIzi8cQY7mv","executionInfo":{"status":"ok","timestamp":1718099159479,"user_tz":-480,"elapsed":37,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"592bb06c-6bed-404e-f76a-1e8a56e7fe0e","colab":{"base_uri":"https://localhost:8080/"}},"cell_type":"code","source":["# Displaying the first few rows of each dataframe to verify loading\n","print(\"Train Data:\")\n","print(traindf.head())"],"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["Train Data:\n","  catgtid    text                                                                                                                             angeranticipationdisgustfearjoyloveoptimismpessimismsadnesssurprisetrust\n","0                                              2017-                                                                                                                                                                  \n","1                                                En-                                                                                                                                                                  \n","2  trng 21441â€œWorry is a down payment on a proble...                                                                                                                                                                  \n","3                                              2017-                                                                                                                                                                  \n","4                                                En-                                                                                                                                                                  \n"]}]},{"cell_type":"code","source":["print(\"\\nDev Data:\")\n","print(devdf.head())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"G3d6VioRnDYJ","executionInfo":{"status":"ok","timestamp":1718099159479,"user_tz":-480,"elapsed":35,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"8849c3ea-aa4a-4ded-d3df-52a1bfc08739"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","Dev Data:\n","  ,text,id,author,subreddit,link_id,parent_id,created_utc,rater_id,example_very_unclear,admiration,amusement,anger,annoyance,approval,caring,confusion,curiosity,desire,disappointment,disapproval,disgust,embarrassment,excitement,fear,gratitude,grief,joy,love,nervousness,optimism,pride,realization,relief,remorse,sadness,surprise,neutral\n","0  0,That game hurt.,eew5j0j,Brdd9,nrl,t3_ajis4z,...                                                                                                                                                                                                                                                                                            \n","1  1,\" >sexuality shouldnâ€™t be a grouping categor...                                                                                                                                                                                                                                                                                            \n","2  2,\"You do right, if you don't care then fuck '...                                                                                                                                                                                                                                                                                            \n","3  3,Man I love reddit.,eeibobj,MrsRobertshaw,fac...                                                                                                                                                                                                                                                                                            \n","4  4,\"[NAME] was nowhere near them, he was by the...                                                                                                                                                                                                                                                                                            \n"]}]},{"metadata":{"trusted":true,"id":"N7zMzYoPY7mv","executionInfo":{"status":"ok","timestamp":1718099159479,"user_tz":-480,"elapsed":31,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"2a4d45a6-dd8e-4e93-9dce-92f5786c6b6d","colab":{"base_uri":"https://localhost:8080/"}},"cell_type":"code","source":["print(\"\\nTest Data:\")\n","print(testdf.head())"],"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","Test Data:\n","Empty DataFrame\n","Columns: [\f]\n","Index: []\n"]}]},{"cell_type":"code","source":["print(\"\\nGoEmotions Full Data:\")\n","print(goemotions_full.head())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"m_C6do-6nHoy","executionInfo":{"status":"ok","timestamp":1718099159480,"user_tz":-480,"elapsed":28,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"8e19e198-4a97-4a8a-a769-e66d2e3bd09c"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","GoEmotions Full Data:\n","   Unnamed: 0                                               text       id  \\\n","0           0                                    That game hurt.  eew5j0j   \n","1           1   >sexuality shouldnâ€™t be a grouping category I...  eemcysk   \n","2           2     You do right, if you don't care then fuck 'em!  ed2mah1   \n","3           3                                 Man I love reddit.  eeibobj   \n","4           4  [NAME] was nowhere near them, he was by the Fa...  eda6yn6   \n","\n","                author            subreddit    link_id   parent_id  \\\n","0                Brdd9                  nrl  t3_ajis4z  t1_eew18eq   \n","1          TheGreen888     unpopularopinion  t3_ai4q37   t3_ai4q37   \n","2             Labalool          confessions  t3_abru74  t1_ed2m7g7   \n","3        MrsRobertshaw             facepalm  t3_ahulml   t3_ahulml   \n","4  American_Fascist713  starwarsspeculation  t3_ackt2f  t1_eda65q2   \n","\n","    created_utc  rater_id  example_very_unclear  ...  love  nervousness  \\\n","0  1.548381e+09         1                 False  ...     0            0   \n","1  1.548084e+09        37                  True  ...     0            0   \n","2  1.546428e+09        37                 False  ...     0            0   \n","3  1.547965e+09        18                 False  ...     1            0   \n","4  1.546669e+09         2                 False  ...     0            0   \n","\n","   optimism  pride  realization  relief  remorse  sadness  surprise  neutral  \n","0         0      0            0       0        0        1         0        0  \n","1         0      0            0       0        0        0         0        0  \n","2         0      0            0       0        0        0         0        1  \n","3         0      0            0       0        0        0         0        0  \n","4         0      0            0       0        0        0         0        1  \n","\n","[5 rows x 38 columns]\n"]}]},{"cell_type":"code","source":["print(\"\\nSemEval 2018 Task 1 EMOC Data:\")\n","print(semeval2018_task1_emoc.head())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_HbkJY0JnL0B","executionInfo":{"status":"ok","timestamp":1718099159480,"user_tz":-480,"elapsed":25,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"b26a5fdd-cb37-4605-e9ef-f00e0536c24e"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","SemEval 2018 Task 1 EMOC Data:\n","   catg            tid                                               text  \\\n","0  trng  2017-En-21441  â€œWorry is a down payment on a problem you may ...   \n","1  trng  2017-En-31535  Whatever you decide to do make sure it makes y...   \n","2  trng  2017-En-21068  @Max_Kellerman  it also helps that the majorit...   \n","3  trng  2017-En-31436  Accept the challenges so that you can literall...   \n","4  trng  2017-En-22195  My roommate: it's okay that we can't spell bec...   \n","\n","   anger  anticipation  disgust  fear  joy  love  optimism  pessimism  \\\n","0      0             1        0     0    0     0         1          0   \n","1      0             0        0     0    1     1         1          0   \n","2      1             0        1     0    1     0         1          0   \n","3      0             0        0     0    1     0         1          0   \n","4      1             0        1     0    0     0         0          0   \n","\n","   sadness  surprise  trust  \n","0        0         0      1  \n","1        0         0      0  \n","2        0         0      0  \n","3        0         0      0  \n","4        0         0      0  \n"]}]},{"cell_type":"code","source":["print(\"\\nTEC Data:\")\n","print(tec.head())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OkJnmuVonOuT","executionInfo":{"status":"ok","timestamp":1718099159480,"user_tz":-480,"elapsed":20,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"415caf6c-ad42-4936-c078-793ecf582cb9"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","TEC Data:\n","                  tid                                               text  \\\n","0  145353048817012736  Thinks that @melbahughes had a great 50th birt...   \n","1  144279638024257536  Como una expresiÃ³n tan simple, una sola oraciÃ³...   \n","2  140499585285111809  the moment when you get another follower and y...   \n","3  145207578270507009  Be the greatest dancer of your life! practice ...   \n","4  139502146390470656  eww.. my moms starting to make her annual rum ...   \n","\n","    emotion  \n","0  surprise  \n","1   sadness  \n","2       joy  \n","3       joy  \n","4   disgust  \n"]}]},{"metadata":{"id":"KB9W3VJYY7mv"},"cell_type":"markdown","source":["**Preprocessing**"]},{"metadata":{"trusted":true,"id":"rVv3fwJJY7mw","executionInfo":{"status":"ok","timestamp":1718099159480,"user_tz":-480,"elapsed":17,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"f2327f74-dd06-412f-c56e-1a667154125a"},"cell_type":"code","source":["#import regular expression library\n","import re\n","\n","# Check if 'Tweet' column exists before extracting hashtags\n","if 'Tweet' in traindf.columns:\n","    traindf[\"hashtags\"]=traindf[\"Tweet\"].apply(lambda x:re.findall(r\"#(\\w+)\",x))\n","else:\n","    print(\"Column 'Tweet' not found in traindf\")\n","\n","if 'Tweet' in devdf.columns:\n","    devdf[\"hashtags\"]=devdf[\"Tweet\"].apply(lambda x:re.findall(r\"#(\\w+)\",x))\n","else:\n","    print(\"Column 'Tweet' not found in devdf\")\n","\n","if 'Tweet' in testdf.columns:\n","    testdf[\"hashtags\"]=testdf[\"Tweet\"].apply(lambda x:re.findall(r\"#(\\w+)\",x))\n","else:\n","    print(\"Column 'Tweet' not found in testdf\")"],"execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["Column 'Tweet' not found in traindf\n","Column 'Tweet' not found in devdf\n","Column 'Tweet' not found in testdf\n"]}]},{"metadata":{"trusted":true,"id":"x93I6oqbY7mw","executionInfo":{"status":"ok","timestamp":1718099159480,"user_tz":-480,"elapsed":14,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"980e6314-bead-4d38-b3a9-d624de27a6cc","colab":{"base_uri":"https://localhost:8080/","height":363}},"cell_type":"code","source":["#display first rows in training data\n","traindf.head(10)"],"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  catgtid    text                                                                                                                             angeranticipationdisgustfearjoyloveoptimismpessimismsadnesssurprisetrust\n","0                                              2017-                                                                                                                                                                  \n","1                                                En-                                                                                                                                                                  \n","2  trng 21441â€œWorry is a down payment on a proble...                                                                                                                                                                  \n","3                                              2017-                                                                                                                                                                  \n","4                                                En-                                                                                                                                                                  \n","5  trng 31535Whatever you decide to do make sure ...                                                                                                                                                                  \n","6                                              2017-                                                                                                                                                                  \n","7       En- @Max_Kellerman it also helps that the...                                                                                                                                                                  \n","8  trng 21068#GOPATS                             ...                                                                                                                                                                  \n","9                                              2017-                                                                                                                                                                  "],"text/html":["\n","  <div id=\"df-b5243e03-66ed-4c71-a24d-a14926b67f16\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>catgtid    text                                                                                                                             angeranticipationdisgustfearjoyloveoptimismpessimismsadnesssurprisetrust</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2017-</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>En-</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>trng 21441â€œWorry is a down payment on a proble...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2017-</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>En-</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>trng 31535Whatever you decide to do make sure ...</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>2017-</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>En- @Max_Kellerman it also helps that the...</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>trng 21068#GOPATS                             ...</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>2017-</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b5243e03-66ed-4c71-a24d-a14926b67f16')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-b5243e03-66ed-4c71-a24d-a14926b67f16 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-b5243e03-66ed-4c71-a24d-a14926b67f16');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-b3b006cc-790e-49e4-8d85-c264d50e1b49\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-b3b006cc-790e-49e4-8d85-c264d50e1b49')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-b3b006cc-790e-49e4-8d85-c264d50e1b49 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"traindf","summary":"{\n  \"name\": \"traindf\",\n  \"rows\": 33085,\n  \"fields\": [\n    {\n      \"column\": \"catgtid    text                                                                                                                             angeranticipationdisgustfearjoyloveoptimismpessimismsadnesssurprisetrust\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 14174,\n        \"samples\": [\n          \"     En- Isn't the whole 'it's been hijacked' argument the same argument used to ban or discourage the display of the St George's\",\n          \"devt020634 hours. \\\\n4,189 words.\\\\n1 story.\\\\n#amwriting #horror #publishorperish                                                              0   0   1   1 1   0   0   0   1   0   0\",\n          \"trng 40220#unhappy                                                                                                                                 1   0   1   0 0   0   0   0   1   0   0\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":11}]},{"metadata":{"trusted":true,"id":"_dm-phAeY7mw","executionInfo":{"status":"ok","timestamp":1718099159480,"user_tz":-480,"elapsed":12,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"5ada796f-b84d-49c6-cca0-08c97cd96ea3","colab":{"base_uri":"https://localhost:8080/","height":53}},"cell_type":"code","source":["#display first rows in testing data\n","testdf.head(10)"],"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Empty DataFrame\n","Columns: [\n","]\n","Index: []"],"text/html":["\n","  <div id=\"df-5043a94b-1265-4fe7-9a93-6f8ed504449d\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5043a94b-1265-4fe7-9a93-6f8ed504449d')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-5043a94b-1265-4fe7-9a93-6f8ed504449d button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-5043a94b-1265-4fe7-9a93-6f8ed504449d');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"testdf","repr_error":"Out of range float values are not JSON compliant: nan"}},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["!pip install emoji"],"metadata":{"id":"qmdfK-4qaubb","executionInfo":{"status":"ok","timestamp":1718099168241,"user_tz":-480,"elapsed":8771,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"b7f7dce8-5bd4-4b54-b131-5475a2f98ab9","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: emoji in /usr/local/lib/python3.10/dist-packages (2.12.1)\n","Requirement already satisfied: typing-extensions>=4.7.0 in /usr/local/lib/python3.10/dist-packages (from emoji) (4.12.1)\n"]}]},{"metadata":{"trusted":true,"id":"VX6kjOAMY7mx","executionInfo":{"status":"ok","timestamp":1718099168241,"user_tz":-480,"elapsed":21,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"04c288b2-0e81-434f-a784-eacf832ff9c4"},"cell_type":"code","source":["import emoji\n","\n","# Translate emojis in training\n","if 'Tweet' in traindf.columns:\n","    traindf[\"clean\"] = traindf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    print(\"Column 'Tweet' not found in traindf\")\n","\n","# Translate emojis in develop\n","if 'Tweet' in devdf.columns:\n","    devdf[\"clean\"] = devdf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    print(\"Column 'Tweet' not found in devdf\")\n","\n","# Translate emojis in testing\n","if 'Tweet' in testdf.columns:\n","    testdf[\"clean\"] = testdf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    print(\"Column 'Tweet' not found in testdf\")"],"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["Column 'Tweet' not found in traindf\n","Column 'Tweet' not found in devdf\n","Column 'Tweet' not found in testdf\n"]}]},{"metadata":{"trusted":true,"id":"TBQAkYVXY7mx","executionInfo":{"status":"ok","timestamp":1718099168241,"user_tz":-480,"elapsed":18,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"81f676fb-1eba-4af7-ffaa-1a5aae8ac63c"},"cell_type":"code","source":["import emoji\n","import re # Don't forget to import the 're' module for regular expressions\n","\n","# Translate emojis in training\n","if 'Tweet' in traindf.columns:\n","    traindf[\"clean\"] = traindf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    print(\"Column 'Tweet' not found in traindf\")\n","\n","# Translate emojis in develop\n","if 'Tweet' in devdf.columns:\n","    devdf[\"clean\"] = devdf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    print(\"Column 'Tweet' not found in devdf\")\n","\n","# Translate emojis in testing\n","if 'Tweet' in testdf.columns:\n","    testdf[\"clean\"] = testdf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    print(\"Column 'Tweet' not found in testdf\")\n","\n","#remove urls in training\n","if 'clean' in traindf.columns:\n","    traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: re.sub(r\"http:\\S+\",'',x))\n","else:\n","    print(\"Column 'clean' not found in traindf\")\n","\n","#remove urls in develop\n","if 'clean' in devdf.columns:\n","    devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: re.sub(r\"http:\\S+\",'',x))\n","else:\n","    print(\"Column 'clean' not found in devdf\")\n","\n","#remove urls in testing\n","if 'clean' in testdf.columns:\n","    testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: re.sub(r\"http:\\S+\",'',x))\n","else:\n","    print(\"Column 'clean' not found in testdf\")"],"execution_count":15,"outputs":[{"output_type":"stream","name":"stdout","text":["Column 'Tweet' not found in traindf\n","Column 'Tweet' not found in devdf\n","Column 'Tweet' not found in testdf\n","Column 'clean' not found in traindf\n","Column 'clean' not found in devdf\n","Column 'clean' not found in testdf\n"]}]},{"cell_type":"code","source":["# Install the NLTK package\n","!pip install nltk"],"metadata":{"id":"LKf6N2U0gkOt","executionInfo":{"status":"ok","timestamp":1718099178047,"user_tz":-480,"elapsed":9822,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"b67664d2-52fc-4404-f696-e2b55a171d9a","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":16,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: nltk in /usr/local/lib/python3.10/dist-packages (3.8.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.10/dist-packages (from nltk) (8.1.7)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.10/dist-packages (from nltk) (1.4.2)\n","Requirement already satisfied: regex>=2021.8.3 in /usr/local/lib/python3.10/dist-packages (from nltk) (2024.5.15)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from nltk) (4.66.4)\n"]}]},{"cell_type":"code","source":["import nltk\n","\n","# Download the punkt tokenizer resource\n","nltk.download('punkt')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UFveSSQQORDI","executionInfo":{"status":"ok","timestamp":1718099180072,"user_tz":-480,"elapsed":2031,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"b09b598f-96c0-4d51-ce60-9e77fa257eb5"},"execution_count":17,"outputs":[{"output_type":"stream","name":"stderr","text":["[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Package punkt is already up-to-date!\n"]},{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":17}]},{"metadata":{"trusted":true,"id":"kRN8nSS4Y7mx","executionInfo":{"status":"ok","timestamp":1718099279039,"user_tz":-480,"elapsed":13300,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"09a76b3a-5c19-42c2-9d66-a43b3e91bafe","colab":{"base_uri":"https://localhost:8080/"}},"cell_type":"code","source":["import emoji\n","import re\n","import nltk\n","\n","# Translate emojis and create 'clean' column in training\n","if 'Tweet' in traindf.columns:\n","    traindf[\"clean\"] = traindf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    # Handle the case where 'Tweet' column is missing, e.g., create an empty 'clean' column\n","    traindf[\"clean\"] = \"\"\n","    print(\"Column 'Tweet' not found in traindf, creating an empty 'clean' column\")\n","\n","# Translate emojis and create 'clean' column in develop\n","if 'Tweet' in devdf.columns:\n","    devdf[\"clean\"] = devdf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    devdf[\"clean\"] = \"\"\n","    print(\"Column 'Tweet' not found in devdf, creating an empty 'clean' column\")\n","\n","# Translate emojis and create 'clean' column in testing\n","if 'Tweet' in testdf.columns:\n","    testdf[\"clean\"] = testdf[\"Tweet\"].apply(lambda x: emoji.demojize(x))\n","else:\n","    testdf[\"clean\"] = \"\"\n","    print(\"Column 'Tweet' not found in testdf, creating an empty 'clean' column\")\n","\n","#remove urls in training\n","if 'clean' in traindf.columns:\n","    traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: re.sub(r\"http:\\S+\",'',x))\n","else:\n","    print(\"Column 'clean' not found in traindf\")\n","\n","#remove urls in develop\n","if 'clean' in devdf.columns:\n","    devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: re.sub(r\"http:\\S+\",'',x))\n","else:\n","    print(\"Column 'clean' not found in devdf\")\n","\n","#remove urls in testing\n","if 'clean' in testdf.columns:\n","    testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: re.sub(r\"http:\\S+\",'',x))\n","else:\n","    print(\"Column 'clean' not found in testdf\")\n","\n","#tokenize training tweet\n","traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: nltk.word_tokenize(str(x).lower()))\n","\n","#tokenize develop tweet\n","devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: nltk.word_tokenize(str(x).lower()))\n","\n","#tokenize testing tweet\n","testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: nltk.word_tokenize(str(x).lower()))"],"execution_count":19,"outputs":[{"output_type":"stream","name":"stdout","text":["Column 'Tweet' not found in traindf, creating an empty 'clean' column\n","Column 'Tweet' not found in devdf, creating an empty 'clean' column\n","Column 'Tweet' not found in testdf, creating an empty 'clean' column\n"]}]},{"cell_type":"code","source":["import nltk\n","\n","# Download the stopwords corpus\n","nltk.download('stopwords')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yyBhnPXuOd3V","executionInfo":{"status":"ok","timestamp":1718099285347,"user_tz":-480,"elapsed":745,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"outputId":"86b3bdca-9f9d-426b-934b-fb0db1cd1b43"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stderr","text":["[nltk_data] Downloading package stopwords to /root/nltk_data...\n","[nltk_data]   Package stopwords is already up-to-date!\n"]},{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":20}]},{"metadata":{"trusted":true,"id":"xkVbDa72Y7mx","executionInfo":{"status":"ok","timestamp":1718099289973,"user_tz":-480,"elapsed":2075,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["#import stopwords corpus from nltk\n","from nltk.corpus import stopwords\n","import string #load punctuation charachers\n","\n","#remove stopwords and punctuations\n","stopwrds = set(stopwords.words('english'))\n","\n","#training data\n","traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: [y for y in x if (y not in stopwrds)])\n","traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: [re.sub(r'['+string.punctuation+']','',y) for y in x])\n","traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: [re.sub('\\\\n','',y) for y in x])\n","\n","#develop data\n","devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: [y for y in x if (y not in stopwrds)])\n","devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: [re.sub(r'['+string.punctuation+']','',y) for y in x])\n","devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: [re.sub('\\\\n','',y) for y in x])\n","\n","#testing data\n","testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: [y for y in x if (y not in stopwrds)])\n","testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: [re.sub(r'['+string.punctuation+']','',y) for y in x])\n","testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: [re.sub('\\\\n','',y) for y in x])"],"execution_count":21,"outputs":[]},{"metadata":{"trusted":true,"id":"cZOFch60Y7mx","executionInfo":{"status":"ok","timestamp":1718099293499,"user_tz":-480,"elapsed":495,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["#clean unneeded spaces or empty columns or non sense words\n","\n","#training data\n","traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: [y for y in x if y.strip() != '' and len(y.strip())>2])\n","\n","#develop data\n","devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: [y for y in x if y.strip() != '' and len(y.strip())>2])\n","\n","#testing data\n","testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: [y for y in x if y.strip() != '' and len(y.strip())>2])"],"execution_count":22,"outputs":[]},{"metadata":{"trusted":true,"id":"Ncw_xi_ZY7my","executionInfo":{"status":"ok","timestamp":1718099296851,"user_tz":-480,"elapsed":565,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"colab":{"base_uri":"https://localhost:8080/","height":363},"outputId":"247ea13b-4c40-41b2-fb5a-8f133207ad32"},"cell_type":"code","source":["traindf.head(10)"],"execution_count":23,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  catgtid    text                                                                                                                             angeranticipationdisgustfearjoyloveoptimismpessimismsadnesssurprisetrust  \\\n","0                                              2017-                                                                                                                                                                     \n","1                                                En-                                                                                                                                                                     \n","2  trng 21441â€œWorry is a down payment on a proble...                                                                                                                                                                     \n","3                                              2017-                                                                                                                                                                     \n","4                                                En-                                                                                                                                                                     \n","5  trng 31535Whatever you decide to do make sure ...                                                                                                                                                                     \n","6                                              2017-                                                                                                                                                                     \n","7       En- @Max_Kellerman it also helps that the...                                                                                                                                                                     \n","8  trng 21068#GOPATS                             ...                                                                                                                                                                     \n","9                                              2017-                                                                                                                                                                     \n","\n","  clean  \n","0    []  \n","1    []  \n","2    []  \n","3    []  \n","4    []  \n","5    []  \n","6    []  \n","7    []  \n","8    []  \n","9    []  "],"text/html":["\n","  <div id=\"df-fe90097c-1a9f-4770-b515-0b9cc1d87610\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>catgtid    text                                                                                                                             angeranticipationdisgustfearjoyloveoptimismpessimismsadnesssurprisetrust</th>\n","      <th>clean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2017-</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>En-</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>trng 21441â€œWorry is a down payment on a proble...</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2017-</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>En-</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>trng 31535Whatever you decide to do make sure ...</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>2017-</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>En- @Max_Kellerman it also helps that the...</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>trng 21068#GOPATS                             ...</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>2017-</td>\n","      <td>[]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fe90097c-1a9f-4770-b515-0b9cc1d87610')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-fe90097c-1a9f-4770-b515-0b9cc1d87610 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-fe90097c-1a9f-4770-b515-0b9cc1d87610');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-27895eef-7ba1-40d1-894a-1ba1e5aaa37a\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-27895eef-7ba1-40d1-894a-1ba1e5aaa37a')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-27895eef-7ba1-40d1-894a-1ba1e5aaa37a button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"traindf","summary":"{\n  \"name\": \"traindf\",\n  \"rows\": 33085,\n  \"fields\": [\n    {\n      \"column\": \"catgtid    text                                                                                                                             angeranticipationdisgustfearjoyloveoptimismpessimismsadnesssurprisetrust\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 14174,\n        \"samples\": [\n          \"     En- Isn't the whole 'it's been hijacked' argument the same argument used to ban or discourage the display of the St George's\",\n          \"devt020634 hours. \\\\n4,189 words.\\\\n1 story.\\\\n#amwriting #horror #publishorperish                                                              0   0   1   1 1   0   0   0   1   0   0\",\n          \"trng 40220#unhappy                                                                                                                                 1   0   1   0 0   0   0   0   1   0   0\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"clean\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":23}]},{"metadata":{"trusted":true,"id":"Y0O_iGv1Y7my","executionInfo":{"status":"error","timestamp":1718099303342,"user_tz":-480,"elapsed":575,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}},"colab":{"base_uri":"https://localhost:8080/","height":428},"outputId":"21ae4958-fd2e-4f7f-df0f-beb3d72cc25b"},"cell_type":"code","source":["#save Cleaned tweets\n","\n","#training data\n","traindf=traindf[[\"clean\",\"hashtags\",\"anger\",\"anticipation\",\"disgust\",\"fear\",\"joy\",\"love\",\"optimism\",\"pessimism\",\"sadness\",\"surprise\",\"trust\"]]\n","\n","#develop data\n","devdf=devdf[[\"clean\",\"hashtags\",\"anger\",\"anticipation\",\"disgust\",\"fear\",\"joy\",\"love\",\"optimism\",\"pessimism\",\"sadness\",\"surprise\",\"trust\"]]\n","\n","#testing data\n","testdf=testdf[[\"clean\",\"hashtags\",\"anger\",\"anticipation\",\"disgust\",\"fear\",\"joy\",\"love\",\"optimism\",\"pessimism\",\"sadness\",\"surprise\",\"trust\"]]"],"execution_count":24,"outputs":[{"output_type":"error","ename":"KeyError","evalue":"\"['hashtags', 'anger', 'anticipation', 'disgust', 'fear', 'joy', 'love', 'optimism', 'pessimism', 'sadness', 'surprise', 'trust'] not in index\"","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m<ipython-input-24-f1f20b7884c0>\u001b[0m in \u001b[0;36m<cell line: 4>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;31m#training data\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m \u001b[0mtraindf\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtraindf\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"clean\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"hashtags\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"anger\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"anticipation\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"disgust\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"fear\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"joy\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"love\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"optimism\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"pessimism\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"sadness\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"surprise\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\"trust\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;31m#develop data\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/core/frame.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m   3765\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mis_iterator\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3766\u001b[0m                 \u001b[0mkey\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3767\u001b[0;31m             \u001b[0mindexer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_indexer_strict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"columns\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3768\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3769\u001b[0m         \u001b[0;31m# take() does not accept boolean indexers\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36m_get_indexer_strict\u001b[0;34m(self, key, axis_name)\u001b[0m\n\u001b[1;32m   5875\u001b[0m             \u001b[0mkeyarr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mindexer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnew_indexer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_reindex_non_unique\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkeyarr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5876\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5877\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_raise_if_missing\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkeyarr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mindexer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis_name\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5878\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5879\u001b[0m         \u001b[0mkeyarr\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtake\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36m_raise_if_missing\u001b[0;34m(self, key, indexer, axis_name)\u001b[0m\n\u001b[1;32m   5939\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5940\u001b[0m             \u001b[0mnot_found\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mensure_index\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mmissing_mask\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnonzero\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0munique\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5941\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"{not_found} not in index\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5942\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5943\u001b[0m     \u001b[0;34m@\u001b[0m\u001b[0moverload\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: \"['hashtags', 'anger', 'anticipation', 'disgust', 'fear', 'joy', 'love', 'optimism', 'pessimism', 'sadness', 'surprise', 'trust'] not in index\""]}]},{"metadata":{"trusted":true,"id":"tyPf6z39Y7my","executionInfo":{"status":"aborted","timestamp":1718099180074,"user_tz":-480,"elapsed":13,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["#Total tweets records\n","len(traindf)"],"execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"id":"YXAejoOSY7my","executionInfo":{"status":"aborted","timestamp":1718099180074,"user_tz":-480,"elapsed":12,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["#counting each emotion\n","val_df=pd.DataFrame([{\"anger\":len(traindf[traindf[\"anger\"]==1]),\n","       \"anticipation\":len(traindf[traindf[\"anticipation\"]==1]),\n","       \"disgust\":len(traindf[traindf[\"disgust\"]==1]),\n","       \"fear\":len(traindf[traindf[\"fear\"]==1]),\n","       \"joy\":len(traindf[traindf[\"joy\"]==1]),\n","       \"love\":len(traindf[traindf[\"love\"]==1]),\n","       \"optimism\":len(traindf[traindf[\"optimism\"]==1]),\n","       \"pessimism\":len(traindf[traindf[\"pessimism\"]==1]),\n","       \"sadness\":len(traindf[traindf[\"sadness\"]==1]),\n","       \"surprise\":len(traindf[traindf[\"surprise\"]==1]),\n","       \"trust\":len(traindf[traindf[\"trust\"]==1])}])\n","val_df\n"],"execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"id":"xYKU5hpBY7my","executionInfo":{"status":"aborted","timestamp":1718099180074,"user_tz":-480,"elapsed":12,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["val_df.iloc[0].plot(kind=\"bar\")"],"execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"id":"jsMlZtShY7my","executionInfo":{"status":"aborted","timestamp":1718099180074,"user_tz":-480,"elapsed":12,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["#convert tokenize tweets to sentences\n","traindf[\"clean\"]=traindf[\"clean\"].apply(lambda x: ' '.join(x).replace('\\\\n',''))\n","devdf[\"clean\"]=devdf[\"clean\"].apply(lambda x: ' '.join(x).replace('\\\\n',''))\n","testdf[\"clean\"]=testdf[\"clean\"].apply(lambda x: ' '.join(x).replace('\\\\n',''))"],"execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"id":"F6veSFrNY7my","executionInfo":{"status":"aborted","timestamp":1718099180074,"user_tz":-480,"elapsed":12,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["traindf.head(10)"],"execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"id":"resreD4HY7mz","executionInfo":{"status":"aborted","timestamp":1718099180075,"user_tz":-480,"elapsed":12,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["testdf.head(10)"],"execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"id":"CVUoyGP0Y7mz","executionInfo":{"status":"aborted","timestamp":1718099180075,"user_tz":-480,"elapsed":12,"user":{"displayName":"MUHAMMAD AJRUL AMIN BIN MOHD ZAIDI","userId":"03324032608270041025"}}},"cell_type":"code","source":["#save clean tweets\n","\n","#training data\n","traindf.to_csv(\"cleaned_training_tweets.csv\",index=False,encoding=\"utf-8\")\n","\n","#develop data\n","devdf.to_csv(\"cleaned_develop_tweets.csv\",index=False,encoding=\"utf-8\")\n","\n","#testing data\n","testdf.to_csv(\"cleaned_testing_tweets.csv\",index=False,encoding=\"utf-8\")"],"execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"language":"python","display_name":"Python 3","name":"python3"},"language_info":{"pygments_lexer":"ipython3","nbconvert_exporter":"python","version":"3.6.4","file_extension":".py","codemirror_mode":{"name":"ipython","version":3},"name":"python","mimetype":"text/x-python"},"colab":{"provenance":[{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/multi-label-classification-tweets-preprocessing-1bc14a72-2428-48dd-a0d3-399420219a3d.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20240611/auto/storage/goog4_request&X-Goog-Date=20240611T034129Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=9621511658226b67dc02977bc561210bf71081f1687649bf60bad87f0943f3e97575ade2f587beea0e788637d6d4d1a323ceb5332b7f609e00a4fe1e563c93a2a416938db85fb589c1012df54213e79e37d6912e69966e34b03a7d60dabd00ad771c39bc2c1d8cc3185a146c8ed80715480d030d48468e60e3d6b9d0379c8c5bd8a5dc8078b866bc7c66ea28032c274f716842c32e99f0979e60a5dfb48024af467ebfe572e901684ded77b483c236b2e7dded15a8f8458c0532668f8b15fa9ab13544a264c7b6fdc138b0896030d1e833a874378770a3636dda5196308c745e2e90695edde072e608c82b8f20e0ce6432e94639316d335c301f7d11d4d963d3","timestamp":1718081486372}]}},"nbformat":4,"nbformat_minor":0}